%Linearised system matrices (uvw,pqr,xyz,euler,omega)
A = reshape([-1.097500e-06;0.000000e+00;0.000000e+00;-4.432200e-05;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-1.097500e-06;0.000000e+00;0.000000e+00;-4.432200e-05;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-1.710500e-05;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-8.619000e-05;-8.619000e-05;-8.619000e-05;-8.619000e-05;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;1.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;9.810000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-9.810000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-1.070000e-02;-1.067000e-01;1.067000e-01;3.400000e-03;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-1.106300e+00;3.400000e-03;-3.400000e-03;3.400000e-03;0.000000e+00;0.000000e+00;-1.070000e-02;1.067000e-01;1.067000e-01;-3.400000e-03;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;3.400000e-03;-1.106300e+00;3.400000e-03;-3.400000e-03;0.000000e+00;0.000000e+00;-1.070000e-02;1.067000e-01;-1.067000e-01;3.400000e-03;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-3.400000e-03;3.400000e-03;-1.106300e+00;3.400000e-03;0.000000e+00;0.000000e+00;-1.070000e-02;-1.067000e-01;-1.067000e-01;-3.400000e-03;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;3.400000e-03;-3.400000e-03;3.400000e-03;-1.106300e+00],[16,16]);
B = reshape([0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;6.215420e+01;-4.459000e-01;4.459000e-01;-4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-4.459000e-01;6.215420e+01;-4.459000e-01;4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;4.459000e-01;-4.459000e-01;6.215420e+01;-4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;4.459000e-01;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;0.000000e+00;-4.459000e-01;4.459000e-01;-4.459000e-01;6.215420e+01],[16,4]);

%SS model
QCc = ss(A,B,eye(16),zeros(16,4));

% % LQR Gains
% Q = eye(16); % Penalize positions and velocities
% R = 1; % Penalize effort
% K = lqr(A,B,Q,R);

% Load MPC controllers
load('mpc_l_all.mat')

% Original K
K = reshape([-5.110766e+00;-5.110828e+00;5.110766e+00;5.110828e+00;-5.110828e+00;5.110766e+00;5.110828e+00;-5.110766e+00;-5.404988e+00;-5.404988e+00;-5.404988e+00;-5.404988e+00;-4.040006e+00;4.040001e+00;4.040006e+00;-4.040001e+00;4.040001e+00;4.040006e+00;-4.040001e+00;-4.040006e+00;-8.161851e-01;8.161851e-01;-8.161851e-01;8.161851e-01;-7.071059e+00;-7.071076e+00;7.071059e+00;7.071076e+00;-7.071076e+00;7.071059e+00;7.071076e+00;-7.071059e+00;-7.071068e+00;-7.071068e+00;-7.071068e+00;-7.071068e+00;-1.811892e+01;1.811885e+01;1.811892e+01;-1.811885e+01;1.811885e+01;1.811892e+01;-1.811885e+01;-1.811892e+01;-5.000000e-01;5.000000e-01;-5.000000e-01;5.000000e-01;1.257982e-01;1.907311e-02;-9.340298e-02;1.907311e-02;1.907311e-02;1.257982e-01;1.907311e-02;-9.340298e-02;-9.340298e-02;1.907311e-02;1.257982e-01;1.907311e-02;1.907311e-02;-9.340298e-02;1.907311e-02;1.257982e-01],[4,16]);